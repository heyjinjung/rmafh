1) 현재 어드민 페이지에서  - 진행중 - 테스트완료
csv 업로드로만 유저의 모든 상태를 관리하는데
어드민 페이지에서 바로 버튼/입력을 해가며 유저에 대한 모든것을 관리할 수 있게 기능 추가 해줘 
필요한 데이터 테이블/ 스키마 리스트업 해서 현재 문서에 추가해줘 
### 어드민 직접 제어용 테이블/스키마 체크리스트
- user_identity: 외부 아이디(아이디) -> 내부 user_id 매핑. 닉네임/가입일 표시 시 조인 기준.
- vault_status: 금고 상태(GOLD/PLATINUM/DIAMOND), 출석 일수, 입금 누적, 만료 시각, 연장 횟수 관리. 어드민 버튼 액션은 이 테이블을 직접 업데이트(멱등 조건 포함).
- vault_expiry_extension_log: 만료 연장 이력 감사. 어드민에서 만료 연장 버튼 클릭 시 request_id 기반으로 중복 방지 기록 필수. (과거 REFERRAL 기록은 감사용 조회만 허용, 신규 write 금지)
- notifications_queue: 만료 D-2/D-day, 출석 리마인드, 소셜프루프 등 알림 큐. 어드민이 “알림 보내기”/“토스트 재발송” 같은 액션을 큐잉할 때 사용. (REFERRAL_REVIVE 타입 폐기)
- compensation_queue: 보상/외부 연동 재시도 큐. CLAIMED 처리 중 장애 시 어드민이 재시도/취소를 걸어둘 때 사용.
- (옵션) audit 테이블: 어드민이 직접 상태를 바꾼 경우 조작 로그를 남길 별도 테이블 또는 vault_expiry_extension_log.metadata 활용.
### 핵심 컬럼 정의(요약)
- user_identity: user_id (PK), external_user_id(아이디, UNIQUE), nickname, joined_at, created_at
- vault_status: user_id(PK), gold_status/platinum_status/diamond_status(LOCKED|UNLOCKED|CLAIMED|EXPIRED), platinum_attendance_days, platinum_deposit_done, diamond_deposit_current, expires_at, expires_initial_at, expiry_extend_count, last_extension_reason, last_extension_at, created_at
- vault_expiry_extension_log: id, user_id, prev_expires_at, new_expires_at, reason(OPS|PROMO|ADMIN), request_id(UNIQUE), shadow, metadata(JSON), created_at (과거 REFERRAL 값은 조회만)
- notifications_queue: id, user_id, type(EXPIRY_D2|EXPIRY_D0|ATTENDANCE_D2|SOCIAL_PROOF), vault_type(GOLD|PLATINUM|DIAMOND), variant_id, dedup_key(UNIQUE), payload(JSON), scheduled_at, status(PENDING|SENT|FAILED|DLQ), retry_count, created_at
- compensation_queue: id, user_id, vault_type, request_id, external_service, payload(JSON), status(PENDING|RETRYING|DONE|FAILED), retry_count, next_retry_at, last_error, created_at
- audit (제안): id, admin_id, user_id, action, before(JSON), after(JSON), request_id, created_at
### 어드민 API 설계(제안)
- GET /admin/users?query=external_user_id|nickname: user_identity + vault_status 조인 조회, 금고별 상태/만료/출석/입금/닉네임 표시.
- POST /admin/users/{user_id}/vault/status: 금고 상태 단일/복수 필드 업데이트. body: {gold_status?, platinum_status?, diamond_status?}. 멱등 조건 WHERE current_status=... 적용.
- POST /admin/users/{user_id}/vault/attendance: 출석 증가/리셋. body: {delta_days, set_days?}. 응답에 now/expires_at 반환.
- POST /admin/users/{user_id}/vault/deposit: 입금 충전/완료 토글. body: {platinum_deposit_done?, diamond_deposit_current?}.
- POST /admin/users/{user_id}/vault/extend-expiry: 만료 연장. body: {request_id, extend_hours, reason, shadow=false}. 로그는 vault_expiry_extension_log에 기록.
- (삭제됨) POST /admin/users/{user_id}/vault/referral-revive: 추천 부활 기능 제거.
- POST /admin/users/{user_id}/notify: 알림 큐잉. body: {type, vault_type?, variant_id?, payload?}. dedup_key로 중복 방지.
- POST /admin/compensation/enqueue: 보상 재시도 큐. body: {user_id, vault_type, request_id, external_service, payload}.
- POST /admin/audit-log: 어드민 수동 조작 기록(옵션). body: {action, user_id, before?, after?, request_id}.
### FE 어드민 UX 가이드(요약)
- 상태 조회 카드: 아이디, 닉네임, 가입일, 금고별 상태/만료/출석/입금/리뷰/텔레그램 표시. 골드/플래티넘/다이아 모두 표시.
- 행 단위 액션 버튼: 출석 +1, 입금 토글, 금고 상태 전환(UNLOCK/CLAIM/EXPIRE), 만료 연장(+시간), 알림 보내기.
- 모든 상태 변경 요청에 request_id(멱등키) 자동 생성하여 서버에 전달.
### 상태 전이 규칙 (금고 공통 원칙)
- 기본 플로우: LOCKED → UNLOCKED → CLAIMED. 만료 시점 도래하면 EXPIRED.
- 허용 전이
	- LOCKED → UNLOCKED (조건 충족 시: 출석/입금 등)
	- UNLOCKED → CLAIMED (보상 수령 완료)
	- LOCKED|UNLOCKED → EXPIRED (만료 도달)
	- EXPIRED → UNLOCKED (만료 연장 시, 요청 시점 상태가 EXPIRED일 때만)
- 차단 전이
	- CLAIMED 이후 다른 상태로 회귀 금지 (오류 반환)
	- EXPIRED가 아닌데 연장 요청 시: 만료만 +시간 연장, 상태는 유지
	- 상태 업데이트 시 WHERE 절에 현재 상태를 포함하여 멱등/경합 방지
### API 응답 스키마 (예시 JSON)
- GET /admin/users
```json
{
	"users": [
		{
			"user_id": 1,
			"external_user_id": "test1",
			"nickname": "네임1",
			"joined_at": "2025-12-20T00:00:00Z",
			"vault": {
				"gold": { "status": "UNLOCKED" },
				"platinum": {
					"status": "UNLOCKED",
					"attendance_days": 1,
					"deposit_done": true
				},
				"diamond": {
					"status": "LOCKED",
					"deposit_current": 0
				},
				"expires_at": "2025-12-25T00:00:00Z"
			}
		}
	]
}
```
- POST /admin/users/{id}/vault/status
```json
{ "updated": true, "vault": { "gold_status": "UNLOCKED", "expires_at": "2025-12-25T00:00:00Z" } }
```
- POST /admin/users/{id}/vault/attendance
```json
{ "platinum_attendance_days": 2, "now": "2025-12-22T12:00:00Z", "expires_at": "2025-12-25T00:00:00Z" }
```
- POST /admin/users/{id}/vault/deposit
```json
{ "platinum_deposit_done": true, "diamond_deposit_current": 1 }
```
- POST /admin/users/{id}/vault/extend-expiry
```json
{ "shadow": false, "updated": 1, "new_expires_at": "2025-12-27T00:00:00Z" }
```
- POST /admin/users/{id}/notify
```json
{ "enqueued": 1 }
```
- POST /admin/compensation/enqueue
```json
{ "enqueued": true }
```

### 프론트 기술 설계 (Admin)
- 페이지: pages/admin.jsx에서 기존 CSV 업로드 탭 옆에 “유저 관리” 탭 추가. 상태 조회 테이블 + 우측 슬라이드 패널(상세/액션).
- 상태 조회 테이블 컬럼: 아이디, 닉네임, 가입일, 골드/플래티넘/다이아 상태, 만료일, 출석(일수), 입금(여부/누적), 텔레그램/리뷰 플래그, 액션 버튼.
- 상태 패널(선택 행 기준): 만료 연장(+시간 입력), 출석 +1, 입금 토글, 금고 상태 전환(UNLOCK/CLAIM/EXPIRE), 알림 보내기(variant 선택).
- 데이터 패칭: SWR or React Query로 /admin/users 목록, 액션 후 invalidate/refetch. 낙관적 업데이트는 멱등 실패 시 롤백.
- 멱등키 생성: FE에서 UUID v4 생성하여 연장/상태변경 요청에 request_id로 첨부.
- 에러 처리: 전이 불가(예: CLAIMED → 다른 상태) 시 토스트 + 상태 재동기화. 만료 연장 shadow 모드 지원 시 “미리보기” 응답 표시.
- 컴포넌트 분리: UsersListViewer(테이블), StatusViewer(상세 패널), ActionBar(버튼 집합), ResponseViewer(최근 요청/응답 로그), CsvUploader 기존 유지.

2) 현재 어드민페이지 상태조회에서
사용자 정보
금고정보가 나오는데
거기에 추가로 사용자 정보네 닉네임 나올수 있게 해주고

금고 정보에 골드 / 플래티넘/ 다이아 이 3개의 모든 금고가 다 조회될수 있게 해줘

### 상태조회 보완 요구사항
- 사용자 정보: external_user_id, nickname, joined_at 모두 표시. FE 테이블 컬럼에 닉네임 추가, API GET /admin/users 응답에 nickname 포함(이미 설계됨).
- 금고 정보: gold/platinum/diamond 각각 상태·진행률·만료일을 모두 노출. 테이블 컬럼에 세 금고 상태를 별도 컬럼으로 배치하고, 상세 패널에서는 출석/입금/만료/리뷰/텔레그램까지 표시.
- 쿼리/조인: GET /admin/users에서 user_identity(nickname, joined_at) ↔ vault_status 조인, 금고별 필드를 모두 반환.

3) 지금 유저페이지에서 로그인 할때 - 작업진행중 - 테스트완료
csv 업로드되어 데이터에 기록된 정보로만 로그인을 해야하는데 그냥 넣기만 하면 자동으로 로그인이 되면서
데이터베이스에 문제가 발생되고 있어
인증 절차 한번 더 확인해줘 
아이디	닉네임	가입일	골드	플래티넘	다이아	출석	입금	텔레그램	리뷰	만료일
user_네임1	네임1	2025. 12. 22.	수령완료	비활성	비활성	0일/0	-	-	-	2025. 12. 25. - 이건 그냥 페이지에서 넣고 바로 기록된 문제레코드야 
test1	네임1	2025. 12. 20.	활성	비활성	비활성	0일/2	-	✓	-	2025. 12. 25.
test4	네임4	2025. 12. 20.	활성	비활성	비활성	1일/2	✓	-	✓	2025. 12. 25.
test2	네임2	2025. 12. 20.	활성	비활성	비활성	0일/2	-	-	-	2025. 12. 25.
test3	네임3	2025. 12. 20.	활성	비활성	비활성	1일/2	✓	✓	✓	2025. 12. 25.
test5	네임5	2025. 12. 20.	활성


4) 추천 상태 되살리기 기능을 백/프론트/데이터에서 모두 삭제해줘  - 완료

### 조치: 추천 부활 기능 제거 지침
- 백엔드: `/api/vault/referral-revive` 엔드포인트 제거, `ALLOWED_NOTIFY_TYPES`에서 REFERRAL_REVIVE 삭제, `notifications_queue` type 금지. 배치/워커 로직도 동일하게 삭제. (완료)
- 프론트: 추천 부활 버튼/폼 제거(UsersListViewer/StatusViewer/ActionBar), 멱등키 생성 부분 삭제. (완료)
- 데이터: `vault_expiry_extension_log`에 reason='REFERRAL' 신규 기록 중단, 기존 기록은 감사용으로만 조회. UNIQUE(user_id, reason='REFERRAL')는 과거 기록 보호용으로 유지. (완료)


5) 푸터에 있는 링크연결해줘 
Contact

CC고객센터 텔레그램  https://t.me/CCCS1009
CC카지노 바로가기 https://ccc-001.com
CC카지노 공식 탤래채널 - 텔레채널로 텍스트도 수정 
 https://t.me/+IE0NYpuze_k1YWZk

### 푸터 링크 연결 지침
- Contact 섹션에 외부 링크로 연결
	- CC고객센터 텔레그램: https://t.me/CCCS1009
	- CC카지노 바로가기: https://ccc-001.com
	- CC카지노 공식 텔레채널: https://t.me/+IE0NYpuze_k1YWZk (라벨 “CC카지노 공식 텔레채널”로 표기)

 6) 플래티넘 금고에 나와있는 이 문구만 삭제 
  연속 진행0/3
리뷰 키 
0/1 (필요)
오늘 조건을 채우면 +1, 하루라도 건너뛰면 1일부터 다시 시작돼요.

미션 체크리스트에 있는 정보는 그대로 둘것 

<div class="bg-black/30 border border-white/10 rounded-lg px-3 py-2"><div class="flex items-center justify-between text-sm"><span class="text-white/80 font-medium">연속 진행</span><span class="text-white font-bold">0<!-- -->/3</span></div><div class="mt-2 flex items-center justify-between text-xs"><span class="text-white/60">리뷰 키</span><span class="text-white/80 font-semibold">0/1 (필요)</span></div><div class="mt-2 text-xs text-white/60">오늘 조건을 채우면 +1, 하루라도 건너뛰면 1일부터 다시 시작돼요.</div></div>

